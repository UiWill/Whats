üó∫Ô∏è Mapa da API ‚Äì Fluxo completo
1. Origem do evento

Voc√™ clica no bot√£o no seu sistema (ERP).

Esse clique chama sua API passando o CNPJ da empresa.

2. API ‚Äì Entrada

Endpoint (exemplo):

POST /api/enviar-relatorio
Body: { "cnpj": "62567108000101" }

3. Consulta no Banco Oracle

A API conecta no banco Oracle (config que voc√™ mostrou).

Consulta na tabela D_EMPRESAS:

SELECT NUMERO_WHATSAPP_GRUPO
FROM D_EMPRESAS
WHERE CNPJ_CO2 = :cnpj


Retorna o n√∫mero do grupo correspondente √† empresa.

4. Montagem do caminho da imagem

Com o cnpj, a API monta o caminho do arquivo:

C:\br.com.ControleVendaComercio\ERP_{cnpj}_VENDAS_COMERCIO\RelatorioVendas.jpg


Exemplo:

C:\br.com.ControleVendaComercio\ERP_62567108000101_VENDAS_COMERCIO\RelatorioVendas.jpg

5. Upload da imagem

Agora voc√™ tem duas op√ß√µes:

(A) Enviar imagem local

A API l√™ o arquivo .jpg do caminho local.

Usa curl_file_create (PHP) ou form-data (Node.js) para enviar o bin√°rio pro Whatsmeow / WPPConnect.

(B) Enviar por URL

Se o seu sistema expuser essa imagem via servidor HTTP (ex: http://meuserver/relatorios/{cnpj}/RelatorioVendas.jpg),
fica mais simples ‚Üí API s√≥ manda a URL pro WhatsApp.

6. Envio para WhatsApp

A API chama o servi√ßo de mensagens (Whatsmeow, WPPConnect ou outro).

Passa:

phone: n√∫mero do grupo (ex: 1203xxxx@g.us)

filename: "RelatorioVendas.jpg"

caption: "Relat√≥rio do dia"

Arquivo (file) ou URL (path)

7. Resposta

Se envio ok ‚Üí retorna 200 { "status": "enviado" }

Se erro ‚Üí retorna 400 { "status": "erro", "mensagem": "n√£o achou imagem" }

üìå Estrutura da API
Endpoints principais

POST /api/enviar-relatorio

Entrada: { "cnpj": "..." }

A√ß√£o: consulta DB, pega caminho, envia imagem para grupo.

Sa√≠da: { "status": "enviado", "grupo": "...", "cnpj": "..." }

(Opcional) GET /api/teste-conexao

Para validar se est√° conectado no banco e no WhatsApp.

üîí Boas pr√°ticas para n√£o cair

Tratar erros (arquivo n√£o existe, grupo n√£o encontrado, conex√£o caiu).

Logs (guardar data/hora de cada envio).

Fila de envio se um dia precisar mandar pra muitas empresas.

Controle de sess√£o WhatsApp (se usar WPPConnect, monitorar se a sess√£o caiu e reautenticar).

üëâ Resumindo:

ERP ‚Üí chama API com CNPJ ‚Üí API consulta Oracle ‚Üí acha grupo ‚Üí monta caminho ‚Üí pega imagem ‚Üí envia pro WhatsApp.




para coenctar no oracle aqui esta a senha 
Nome do usuario: DID_SISTEMAS
Senha: D_d2017

nome do Host: nuvem.dnotas.com.br
porta: 1521
SID: xe
